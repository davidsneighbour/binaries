#!/bin/bash
# v2024.11.23.01

set -e

REQUIRED_TOOLS=(
  curl
  sed
  git
)
CURPATH="$(pwd -P)"
SCRIPTPATH="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Define the library directory relative to the script directory
lib_dir="$SCRIPTPATH/../lib"

# Verbosity flag (set to 'true' for verbose output, 'false' for silent mode)
verbose=true

# Check if the library directory exists
if [ -d "$lib_dir" ]; then
  # Optionally display the library path being loaded
  if [ "$verbose" == "true" ]; then
    echo "Loading library files from: $lib_dir"
  fi

  # Loop through and source all .sh files in the library directory
  for lib_file in "$lib_dir"/*.sh; do
    if [ -f "$lib_file" ]; then
      if [ "$verbose" == "true" ]; then
        echo "Sourcing: $lib_file"
      fi
      # shellcheck source=/dev/null
      source "$lib_file"
    fi
  done
else
  echo "Library directory not found: $lib_dir" >&2
  exit 1
fi

check_required_tools "${REQUIRED_TOOLS[@]}"
load_env_files false
